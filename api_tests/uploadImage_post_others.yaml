# Test generated by RoostGPT for test roostPostmanTest using AI Type Azure Open AI and AI Model roost-gpt4-32k

# RoostTestHash=354b987cbe

config:
  target: "{{ $processEnvironment.API_HOST }}"
  processor: ""  
  plugins:
    expect: {}  
  payload:
    path: "uploadImage_post_others.csv"
    fields: 
      - "petId"
      - "additionalMetadata"
      - "file"
    skipHeader: true

scenarios:
  - name: "Testing /pet/{petId}/uploadImage API for error handling and edge cases"
    flow:
      
    # Case: Invalid Authorization token is used
    - log: "Testing case where Invalid Authorization token is used"
      post:
        url: "/pet/{{ petId }}/uploadImage"
        headers: 
          Authorization: "Invalid-Token"
        formData:
          additionalMetadata: "{{ additionalMetadata }}"
          file: "{{ file }}"
        expect:
          - statusCode: 401 
          - hasProperty: "message"  # check if the response body has a "message" field
          - bodyContains: "Unauthorized Access" # in error case, it is expected to have this message in the body
      
    # Adding a delay between requests
    - think: 1 

    # Case: Invalid URL
    - log: "Testing case where invalid URL is used"
      post:
        url: "/pet/{{ petId }}/invalidURL" 
        headers:
          Authorization: "{{ $processEnvironment.AUTH_TOKEN }}"
        formData:
          additionalMetadata: "{{ additionalMetadata }}"
          file: "{{ file }}"
        expect:
          - statusCode: 404
          - hasProperty: "message"  # check if the response body has a "message" field
          - bodyContains: "URL not found" # in error case, it is expected to have this message in the body  

    # Adding a delay between requests
    - think: 1 

    # Case: All required fields are not provided in payload
    - log: "Testing case where all required fields are not provided"
      post:
        url: "/pet/{{ petId }}/uploadImage"  
        headers:
          Authorization: "{{ $processEnvironment.AUTH_TOKEN }}"
        formData:
          additionalMetadata: "{{ additionalMetadata }}" # file field is not provided
        expect:
          - statusCode: 400 
          - hasProperty: "message" 
          - bodyContains: "Bad request error: Missing required fields"
