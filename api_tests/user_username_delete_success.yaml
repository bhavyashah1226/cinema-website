# Test generated by RoostGPT for test roostPostmanTest using AI Type Azure Open AI and AI Model roost-gpt4-32k

# RoostTestHash=d8125b8dc9

config:
  target: "{{ $processEnvironment.API_HOST }}"
  ensure:
    - log: 'Checking API responsiveness'
    - think: 1
  plugins:
    expect: {}
  payload:
    path: "user_username_delete_success.csv"
    fields: 
      - "username"
    skipHeader: false

scenarios:
  - flow: 
    - log: 'Deleting the user by using username from payload'
    - delete: "/user/{{ username }}"
      headers:
        Authorization: "{{ $processEnvironment.AUTH_TOKEN }}"
      expect: 
        - statusCode: 204
        - hasProperty: 'message'
        - hasProperty: 'status'
      capture:
        - json: "$.message"
          as: "message"
        - json: "$.status"
          as: "status"
    - think: 1

    - log: 'Trying to delete user again to check if user was deleted in the first request or not'
    - delete: "/user/{{ username }}"
      headers:
        Authorization: "{{ $processEnvironment.AUTH_TOKEN }}"
      expect: 
      - statusCode: 404
      - hasProperty: 'error'
      capture:
        - json: "$.error.message"
          as: "errorMessage"
    - think: 1
